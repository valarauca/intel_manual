<!DOCTYPE html >
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p2001" style="overflow: hidden; position: relative; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	-webkit-transform-origin: top left;
	-moz-transform-origin: top left;
	-o-transform-origin: top left;
	-ms-transform-origin: top left;
	-webkit-transform: scale(0.25);
	-moz-transform: scale(0.25);
	-o-transform: scale(0.25);
	-ms-transform: scale(0.25);
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_2001{left:69px;top:1124px;}
#t2_2001{left:627px;top:49px;letter-spacing:-0.3px;word-spacing:0.3px;}
#t3_2001{left:784px;top:1124px;letter-spacing:0.1px;word-spacing:-0.4px;}
#t4_2001{left:830px;top:1124px;letter-spacing:0.1px;}
#t5_2001{left:70px;top:101px;letter-spacing:-0.3px;word-spacing:0.2px;}
#t6_2001{left:70px;top:273px;}
#t7_2001{left:70px;top:299px;word-spacing:-1.9px;}
#t8_2001{left:70px;top:316px;letter-spacing:-0.1px;word-spacing:-2px;}
#t9_2001{left:70px;top:333px;letter-spacing:-0.1px;word-spacing:-2px;}
#ta_2001{left:70px;top:350px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tb_2001{left:70px;top:367px;letter-spacing:-0.1px;word-spacing:-2px;}
#tc_2001{left:70px;top:384px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#td_2001{left:70px;top:408px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#te_2001{left:70px;top:425px;letter-spacing:-0.1px;word-spacing:-5.2px;}
#tf_2001{left:70px;top:442px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tg_2001{left:70px;top:458px;letter-spacing:-0.1px;}
#th_2001{left:70px;top:483px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#ti_2001{left:70px;top:500px;letter-spacing:-0.1px;word-spacing:-2px;}
#tj_2001{left:70px;top:524px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tk_2001{left:70px;top:539px;}
#tl_2001{left:96px;top:547px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tm_2001{left:96px;top:564px;letter-spacing:-0.1px;word-spacing:-1.6px;}
#tn_2001{left:70px;top:579px;}
#to_2001{left:96px;top:587px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tp_2001{left:70px;top:602px;}
#tq_2001{left:96px;top:610px;letter-spacing:-0.1px;word-spacing:-1.7px;}
#tr_2001{left:96px;top:626px;}
#ts_2001{left:70px;top:642px;}
#tt_2001{left:96px;top:649px;letter-spacing:-0.1px;word-spacing:-2.5px;}
#tu_2001{left:96px;top:666px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#tv_2001{left:70px;top:681px;}
#tw_2001{left:96px;top:689px;word-spacing:-1.9px;}
#tx_2001{left:96px;top:706px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#ty_2001{left:70px;top:721px;}
#tz_2001{left:96px;top:729px;letter-spacing:-0.2px;word-spacing:-2.4px;}
#t10_2001{left:96px;top:746px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#t11_2001{left:70px;top:761px;}
#t12_2001{left:96px;top:769px;letter-spacing:-0.2px;word-spacing:-1.5px;}
#t13_2001{left:96px;top:785px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#t14_2001{left:70px;top:801px;}
#t15_2001{left:96px;top:808px;letter-spacing:-0.2px;word-spacing:-1.8px;}
#t16_2001{left:96px;top:825px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#t17_2001{left:70px;top:849px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#t18_2001{left:70px;top:874px;word-spacing:-4.7px;}
#t19_2001{left:70px;top:891px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#t1a_2001{left:70px;top:907px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#t1b_2001{left:70px;top:924px;letter-spacing:-0.2px;word-spacing:-1.9px;}
#t1c_2001{left:70px;top:949px;word-spacing:-4.9px;}
#t1d_2001{left:70px;top:966px;word-spacing:-1.9px;}
#t1e_2001{left:70px;top:982px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#t1f_2001{left:70px;top:999px;letter-spacing:-0.1px;word-spacing:-3.3px;}
#t1g_2001{left:70px;top:1016px;}
#t1h_2001{left:70px;top:1040px;word-spacing:-1.9px;}
#t1i_2001{left:70px;top:1057px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#t1j_2001{left:70px;top:1073px;}
#t1k_2001{left:96px;top:1080px;letter-spacing:-0.2px;word-spacing:-1.8px;}
#t1l_2001{left:75px;top:141px;letter-spacing:-0.2px;}
#t1m_2001{left:186px;top:141px;letter-spacing:-0.1px;}
#t1n_2001{left:316px;top:141px;letter-spacing:-0.1px;}
#t1o_2001{left:75px;top:163px;}
#t1p_2001{left:75px;top:185px;}
#t1q_2001{left:186px;top:163px;letter-spacing:-0.3px;}
#t1r_2001{left:316px;top:163px;letter-spacing:-0.2px;}
#t1s_2001{left:316px;top:185px;letter-spacing:-0.1px;}
#t1t_2001{left:316px;top:206px;letter-spacing:-0.1px;}
#t1u_2001{left:316px;top:228px;letter-spacing:-0.2px;word-spacing:0.3px;}

.s1_2001{
	FONT-SIZE: 48.8px;
	FONT-FAMILY: NeoSansIntel_2koi;
	color: rgb(0,0,0);
}

.s2_2001{
	FONT-SIZE: 55px;
	FONT-FAMILY: NeoSansIntel_2koi;
	color: rgb(8,96,168);
}

.s3_2001{
	FONT-SIZE: 73.3px;
	FONT-FAMILY: NeoSansIntelMedium_2kog;
	color: rgb(8,96,168);
}

.s4_2001{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: NeoSansIntelMedium_2kog;
	color: rgb(8,96,168);
}

.s5_2001{
	FONT-SIZE: 55px;
	FONT-FAMILY: Verdana_9zn;
	color: rgb(0,0,0);
}

.s6_2001{
	FONT-SIZE: 85.4px;
	FONT-FAMILY: TimesNewRoman_9zw;
	color: rgb(0,0,0);
}

.s7_2001{
	FONT-SIZE: 55px;
	FONT-FAMILY: NeoSansIntelMedium_2kog;
	color: rgb(0,0,0);
}

.s8_2001{
	FONT-SIZE: 55px;
	FONT-FAMILY: NeoSansIntel_2koi;
	color: rgb(0,0,0);
}

</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts2001" type="text/css" >

@font-face {
	font-family: NeoSansIntelMedium_2kog;
	src: url("fonts/NeoSansIntelMedium_2kog.woff") format("woff");
}

@font-face {
	font-family: Verdana_9zn;
	src: url("fonts/Verdana_9zn.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_2koi;
	src: url("fonts/NeoSansIntel_2koi.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_9zw;
	src: url("fonts/TimesNewRoman_9zw.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg2001Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg2001" style="-webkit-user-select: none;"><object width="935" height="1210" data="2001/2001.svg" type="image/svg+xml" id="pdf2001" style="width:935px; height:1210px; background-color:white; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div id="t1_2001" class="t s1_2001">GETSEC[SENTER]—Enter a Measured Environment</div>
<div id="t2_2001" class="t s2_2001">SAFER MODE EXTENSIONS REFERENCE</div>
<div id="t3_2001" class="t s1_2001">Vol. 2D</div>
<div id="t4_2001" class="t s1_2001">6-21</div>
<div id="t5_2001" class="t s3_2001">GETSEC[SENTER]—Enter a Measured Environment</div>
<div id="t6_2001" class="t s4_2001">Description</div>
<div id="t7_2001" class="t s5_2001">The GETSEC[SENTER] instruction initiates the launch of a measured environment and places the initiating logical </div>
<div id="t8_2001" class="t s5_2001">processor (ILP) into the authenticated code execution mode. The SENTER leaf of GETSEC is selected with EAX set </div>
<div id="t9_2001" class="t s5_2001">to 4 at execution. The physical base address of the AC module to be loaded and authenticated is specified in EBX. </div>
<div id="ta_2001" class="t s5_2001">The size of the module in bytes is specified in ECX. EDX controls the level of functionality supported by the </div>
<div id="tb_2001" class="t s5_2001">measured environment launch. To enable the full functionality of the protected environment launch, EDX must be </div>
<div id="tc_2001" class="t s5_2001">initialized to zero.</div>
<div id="td_2001" class="t s5_2001">The authenticated code base address and size parameters (in bytes) are passed to the GETSEC[SENTER] instruc-</div>
<div id="te_2001" class="t s5_2001">tion using EBX and ECX respectively. The ILP evaluates the contents of these registers according to the rules for the </div>
<div id="tf_2001" class="t s5_2001">AC module address in GETSEC[ENTERACCS]. AC module execution follows the same rules, as set by </div>
<div id="tg_2001" class="t s5_2001">GETSEC[ENTERACCS].</div>
<div id="th_2001" class="t s5_2001">The launching software must ensure that the TPM.ACCESS_0.activeLocality bit is clear before executing the </div>
<div id="ti_2001" class="t s5_2001">GETSEC[SENTER] instruction.</div>
<div id="tj_2001" class="t s5_2001">There are restrictions enforced by the processor for execution of the GETSEC[SENTER] instruction: </div>
<div id="tk_2001" class="t s6_2001">•</div>
<div id="tl_2001" class="t s5_2001">Execution is not allowed unless the processor is in protected mode or IA-32e mode with CPL = 0 and </div>
<div id="tm_2001" class="t s5_2001">EFLAGS.VM = 0. </div>
<div id="tn_2001" class="t s6_2001">•</div>
<div id="to_2001" class="t s5_2001">Processor cache must be available and not disabled using the CR0.CD and NW bits. </div>
<div id="tp_2001" class="t s6_2001">•</div>
<div id="tq_2001" class="t s5_2001">For enforcing consistency of operation with numeric exception reporting using Interrupt 16, CR0.NE must be </div>
<div id="tr_2001" class="t s5_2001">set. </div>
<div id="ts_2001" class="t s6_2001">•</div>
<div id="tt_2001" class="t s5_2001">An Intel TXT-capable chipset must be present as communicated to the processor by sampling of the power-on </div>
<div id="tu_2001" class="t s5_2001">configuration capability field after reset. </div>
<div id="tv_2001" class="t s6_2001">•</div>
<div id="tw_2001" class="t s5_2001">The processor can not be in authenticated code execution mode or already in a measured environment (as </div>
<div id="tx_2001" class="t s5_2001">launched by a previous GETSEC[ENTERACCS] or GETSEC[SENTER] instruction). </div>
<div id="ty_2001" class="t s6_2001">•</div>
<div id="tz_2001" class="t s5_2001">To avoid potential operability conflicts between modes, the processor is not allowed to execute this instruction </div>
<div id="t10_2001" class="t s5_2001">if it currently is in SMM or VMX operation. </div>
<div id="t11_2001" class="t s6_2001">•</div>
<div id="t12_2001" class="t s5_2001">To insure consistent handling of SIPI messages, the processor executing the GETSEC[SENTER] instruction </div>
<div id="t13_2001" class="t s5_2001">must also be designated the BSP (boot-strap processor) as defined by A32_APIC_BASE.BSP (Bit 8). </div>
<div id="t14_2001" class="t s6_2001">•</div>
<div id="t15_2001" class="t s5_2001">EDX must be initialized to a setting supportable by the processor. Unless enumeration by the GETSEC[PARAM-</div>
<div id="t16_2001" class="t s5_2001">ETERS] leaf reports otherwise, only a value of zero is supported.</div>
<div id="t17_2001" class="t s5_2001">Failure to abide by the above conditions results in the processor signaling a general protection violation.</div>
<div id="t18_2001" class="t s5_2001">This instruction leaf starts the launch of a measured environment by initiating a rendezvous sequence for all logical </div>
<div id="t19_2001" class="t s5_2001">processors in the platform. The rendezvous sequence involves the initiating logical processor sending a message </div>
<div id="t1a_2001" class="t s5_2001">(by executing GETSEC[SENTER]) and other responding logical processors (RLPs) acknowledging the message, </div>
<div id="t1b_2001" class="t s5_2001">thus synchronizing the RLP(s) with the ILP.</div>
<div id="t1c_2001" class="t s5_2001">In response to a message signaling the completion of rendezvous, RLPs clear the bootstrap processor indicator flag </div>
<div id="t1d_2001" class="t s5_2001">(IA32_APIC_BASE.BSP) and enter an SENTER sleep state. In this sleep state, RLPs enter an idle processor condi-</div>
<div id="t1e_2001" class="t s5_2001">tion while waiting to be activated after a measured environment has been established by the system executive. </div>
<div id="t1f_2001" class="t s5_2001">RLPs in the SENTER sleep state can only be activated by the GETSEC leaf function WAKEUP in a measured environ-</div>
<div id="t1g_2001" class="t s5_2001">ment.</div>
<div id="t1h_2001" class="t s5_2001">A successful launch of the measured environment results in the initiating logical processor entering the authenti-</div>
<div id="t1i_2001" class="t s5_2001">cated code execution mode. Prior to reaching this point, the ILP performs the following steps internally: </div>
<div id="t1j_2001" class="t s6_2001">•</div>
<div id="t1k_2001" class="t s5_2001">Inhibit processor response to the external events: INIT, A20M, NMI, and SMI. </div>
<div id="t1l_2001" class="t s7_2001">Opcode</div>
<div id="t1m_2001" class="t s7_2001">Instruction</div>
<div id="t1n_2001" class="t s7_2001">Description</div>
<div id="t1o_2001" class="t s8_2001">0F 37</div>
<div id="t1p_2001" class="t s8_2001">(EAX=4)</div>
<div id="t1q_2001" class="t s8_2001">GETSEC[SENTER]</div>
<div id="t1r_2001" class="t s8_2001">Launch a measured environment.</div>
<div id="t1s_2001" class="t s8_2001">EBX holds the SINIT authenticated code module physical base address.</div>
<div id="t1t_2001" class="t s8_2001">ECX holds the SINIT authenticated code module size (bytes).</div>
<div id="t1u_2001" class="t s8_2001">EDX controls the level of functionality supported by the measured environment launch.</div>

<!-- End text definitions -->


</div>
</body>
</html>
