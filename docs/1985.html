<!DOCTYPE html >
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p1985" style="overflow: hidden; position: relative; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	-webkit-transform-origin: top left;
	-moz-transform-origin: top left;
	-o-transform-origin: top left;
	-ms-transform-origin: top left;
	-webkit-transform: scale(0.25);
	-moz-transform: scale(0.25);
	-o-transform: scale(0.25);
	-ms-transform: scale(0.25);
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_1985{left:627px;top:49px;letter-spacing:-0.3px;word-spacing:0.3px;}
#t2_1985{left:791px;top:1124px;}
#t3_1985{left:837px;top:1124px;}
#t4_1985{left:70px;top:102px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#t5_1985{left:70px;top:119px;letter-spacing:-0.2px;word-spacing:-1.7px;}
#t6_1985{left:70px;top:136px;letter-spacing:-0.1px;word-spacing:-2.2px;}
#t7_1985{left:70px;top:153px;word-spacing:-1.9px;}
#t8_1985{left:70px;top:170px;word-spacing:-1.9px;}
#t9_1985{left:241px;top:170px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#ta_1985{left:70px;top:186px;word-spacing:-1.9px;}
#tb_1985{left:70px;top:203px;letter-spacing:-0.2px;word-spacing:-1.6px;}
#tc_1985{left:70px;top:228px;letter-spacing:-0.1px;word-spacing:-4.5px;}
#td_1985{left:70px;top:244px;word-spacing:-1.9px;}
#te_1985{left:70px;top:261px;letter-spacing:-0.1px;word-spacing:-2.2px;}
#tf_1985{left:70px;top:278px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tg_1985{left:70px;top:295px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#th_1985{left:70px;top:312px;letter-spacing:-0.1px;word-spacing:-3.5px;}
#ti_1985{left:70px;top:328px;letter-spacing:-0.1px;word-spacing:-4.7px;}
#tj_1985{left:70px;top:345px;letter-spacing:-0.1px;word-spacing:-1.7px;}
#tk_1985{left:70px;top:370px;word-spacing:-2px;}
#tl_1985{left:70px;top:387px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#tm_1985{left:680px;top:387px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tn_1985{left:70px;top:403px;word-spacing:-3.7px;}
#to_1985{left:70px;top:420px;letter-spacing:-0.1px;word-spacing:-2.1px;}
#tp_1985{left:70px;top:445px;letter-spacing:-0.1px;word-spacing:-4.9px;}
#tq_1985{left:70px;top:461px;letter-spacing:-0.1px;word-spacing:-3.9px;}
#tr_1985{left:70px;top:478px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#ts_1985{left:70px;top:495px;word-spacing:-1.9px;}
#tt_1985{left:70px;top:512px;}
#tu_1985{left:70px;top:536px;letter-spacing:-0.1px;word-spacing:-5.5px;}
#tv_1985{left:70px;top:553px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#tw_1985{left:70px;top:610px;letter-spacing:0.1px;}
#tx_1985{left:151px;top:610px;letter-spacing:-0.1px;word-spacing:0.1px;}
#ty_1985{left:70px;top:646px;letter-spacing:-0.1px;word-spacing:-5.3px;}
#tz_1985{left:70px;top:663px;letter-spacing:-0.1px;word-spacing:-4.9px;}
#t10_1985{left:70px;top:680px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#t11_1985{left:70px;top:704px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#t12_1985{left:70px;top:721px;letter-spacing:-0.1px;word-spacing:-5.4px;}
#t13_1985{left:70px;top:738px;word-spacing:-2px;}
#t14_1985{left:70px;top:762px;letter-spacing:-0.1px;word-spacing:-1.9px;}
#t15_1985{left:70px;top:779px;letter-spacing:-0.1px;word-spacing:-2.3px;}
#t16_1985{left:70px;top:796px;letter-spacing:-0.1px;word-spacing:-2.2px;}
#t17_1985{left:70px;top:813px;word-spacing:-3.7px;}
#t18_1985{left:219px;top:810px;}
#t19_1985{left:230px;top:813px;letter-spacing:-0.1px;word-spacing:-3.6px;}
#t1a_1985{left:70px;top:830px;letter-spacing:-0.1px;}
#t1b_1985{left:70px;top:854px;letter-spacing:-0.2px;word-spacing:-1.7px;}
#t1c_1985{left:624px;top:851px;}
#t1d_1985{left:640px;top:854px;word-spacing:-1.9px;}
#t1e_1985{left:70px;top:871px;letter-spacing:-0.1px;word-spacing:-1.8px;}
#t1f_1985{left:777px;top:868px;}
#t1g_1985{left:792px;top:871px;letter-spacing:-1.4px;}
#t1h_1985{left:70px;top:888px;word-spacing:-1.9px;}
#t1i_1985{left:361px;top:885px;}
#t1j_1985{left:373px;top:888px;letter-spacing:-0.5px;word-spacing:-1.9px;}
#t1k_1985{left:70px;top:912px;letter-spacing:-0.1px;word-spacing:-4.6px;}
#t1l_1985{left:70px;top:929px;letter-spacing:-0.3px;word-spacing:-4.2px;}
#t1m_1985{left:70px;top:969px;letter-spacing:-0.3px;}
#t1n_1985{left:95px;top:969px;letter-spacing:-0.2px;word-spacing:-1.2px;}
#t1o_1985{left:92px;top:986px;letter-spacing:-0.1px;word-spacing:-1.1px;}
#t1p_1985{left:92px;top:1002px;letter-spacing:-0.2px;word-spacing:0.1px;}
#t1q_1985{left:92px;top:1019px;letter-spacing:-0.2px;word-spacing:0.1px;}
#t1r_1985{left:70px;top:1041px;letter-spacing:-0.3px;}
#t1s_1985{left:92px;top:1041px;letter-spacing:-0.1px;word-spacing:0.1px;}
#t1t_1985{left:92px;top:1057px;letter-spacing:-0.2px;word-spacing:-1.3px;}
#t1u_1985{left:92px;top:1074px;letter-spacing:-0.1px;word-spacing:0.1px;}

.s1_1985{
	FONT-SIZE: 55px;
	FONT-FAMILY: NeoSansIntel_2koi;
	color: rgb(8,96,168);
}

.s2_1985{
	FONT-SIZE: 48.8px;
	FONT-FAMILY: NeoSansIntel_2koi;
	color: rgb(0,0,0);
}

.s3_1985{
	FONT-SIZE: 55px;
	FONT-FAMILY: Verdana_9zn;
	color: rgb(0,0,0);
}

.s4_1985{
	FONT-SIZE: 85.4px;
	FONT-FAMILY: NeoSansIntelMedium_2kog;
	color: rgb(8,96,168);
}

.s5_1985{
	FONT-SIZE: 44px;
	FONT-FAMILY: Verdana_9zn;
	color: rgb(0,0,0);
}

.s6_1985{
	FONT-SIZE: 55px;
	FONT-FAMILY: NeoSansIntel_2koi;
	color: rgb(0,0,0);
}

</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts1985" type="text/css" >

@font-face {
	font-family: Verdana_9zn;
	src: url("fonts/Verdana_9zn.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntelMedium_2kog;
	src: url("fonts/NeoSansIntelMedium_2kog.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_2koi;
	src: url("fonts/NeoSansIntel_2koi.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg1985Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg1985" style="-webkit-user-select: none;"><object width="935" height="1210" data="1985/1985.svg" type="image/svg+xml" id="pdf1985" style="width:935px; height:1210px; background-color:white; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div id="t1_1985" class="t s1_1985">SAFER MODE EXTENSIONS REFERENCE</div>
<div id="t2_1985" class="t s2_1985">Vol. 2D</div>
<div id="t3_1985" class="t s2_1985">6-5</div>
<div id="t4_1985" class="t s3_1985">The life cycle starts with the system executive (an OS, an OS loader, and so forth) loading the MLE and SINIT AC </div>
<div id="t5_1985" class="t s3_1985">module into available system memory. The system executive must validate and prepare the platform for the </div>
<div id="t6_1985" class="t s3_1985">measured launch. When the platform is properly configured, the system executive executes GETSEC[SENTER] on </div>
<div id="t7_1985" class="t s3_1985">the initiating logical processor (ILP) to rendezvous the responding logical processors into an SENTER sleep state, </div>
<div id="t8_1985" class="t s3_1985">the ILP then enters into </div>
<div id="t9_1985" class="t s3_1985">using the SINIT AC module. In a multi-threaded or multi-processing environment, the </div>
<div id="ta_1985" class="t s3_1985">system executive must ensure that other logical processors are already in an idle loop, or asleep (such as after </div>
<div id="tb_1985" class="t s3_1985">executing HLT) before executing GETSEC[SENTER].</div>
<div id="tc_1985" class="t s3_1985">After the GETSEC[SENTER] rendezvous handshake is performed between all logical processors in the platform, the </div>
<div id="td_1985" class="t s3_1985">ILP loads the chipset authenticated code module (SINIT) and performs an authentication check. If the check </div>
<div id="te_1985" class="t s3_1985">passes, the processor hashes the SINIT AC module and stores the result into TPM PCR 17. It then switches execu-</div>
<div id="tf_1985" class="t s3_1985">tion context to the SINIT AC module. The SINIT AC module will perform a number of platform operations, </div>
<div id="tg_1985" class="t s3_1985">including: verifying the system configuration, protecting the system memory used by the MLE from I/O devices </div>
<div id="th_1985" class="t s3_1985">capable of DMA, producing a hash of the MLE, storing the hash value in TPM PCR 18, and various other operations. </div>
<div id="ti_1985" class="t s3_1985">When SINIT completes execution, it executes the GETSEC[EXITAC] instruction and transfers control the MLE at the </div>
<div id="tj_1985" class="t s3_1985">designated entry point. </div>
<div id="tk_1985" class="t s3_1985">Upon receiving control from the SINIT AC module, the MLE must establish its protection and isolation controls </div>
<div id="tl_1985" class="t s3_1985">before enabling DMA and interrupts and transferring control to other software modules. </div>
<div id="tm_1985" class="t s3_1985">It must also wakeup the </div>
<div id="tn_1985" class="t s3_1985">RLPs from their SENTER sleep state using the GETSEC[WAKEUP] instruction and bring them into its protection and </div>
<div id="to_1985" class="t s3_1985">isolation environment.</div>
<div id="tp_1985" class="t s3_1985">While executing in a measured environment, the MVMM can access the Trusted Platform Module (TPM) in locality 2. </div>
<div id="tq_1985" class="t s3_1985">The MVMM has complete access to all TPM commands and may use the TPM to report current measurement values </div>
<div id="tr_1985" class="t s3_1985">or use the measurement values to protect information such that only when the platform configuration registers </div>
<div id="ts_1985" class="t s3_1985">(PCRs) contain the same value is the information released from the TPM. This protection mechanism is known as </div>
<div id="tt_1985" class="t s3_1985">sealing. </div>
<div id="tu_1985" class="t s3_1985">A measured environment shutdown is ultimately completed by executing GETSEC[SEXIT]. Prior to this step system </div>
<div id="tv_1985" class="t s3_1985">software is responsible for scrubbing sensitive information left in the processor caches, system memory.</div>
<div id="tw_1985" class="t s4_1985">6.3 </div>
<div id="tx_1985" class="t s4_1985">GETSEC LEAF FUNCTIONS</div>
<div id="ty_1985" class="t s3_1985">This section provides detailed descriptions of each leaf function of the GETSEC instruction. GETSEC is available only </div>
<div id="tz_1985" class="t s3_1985">if CPUID.01H:ECX[Bit 6] = 1. This indicates the availability of SMX and the GETSEC instruction. Before GETSEC can </div>
<div id="t10_1985" class="t s3_1985">be executed, SMX must be enabled by setting CR4.SMXE[Bit 14] = 1.</div>
<div id="t11_1985" class="t s3_1985">A GETSEC leaf can only be used if it is shown to be available as reported by the GETSEC[CAPABILITIES] function. </div>
<div id="t12_1985" class="t s3_1985">Attempts to access a GETSEC leaf index not supported by the processor, or if CR4.SMXE is 0, results in the signaling </div>
<div id="t13_1985" class="t s3_1985">of an undefined opcode exception.</div>
<div id="t14_1985" class="t s3_1985">All GETSEC leaf functions are available in protected mode, including the compatibility sub-mode of IA-32e mode </div>
<div id="t15_1985" class="t s3_1985">and the 64-bit sub-mode of IA-32e mode. Unless otherwise noted, the behavior of all GETSEC functions and inter-</div>
<div id="t16_1985" class="t s3_1985">actions related to the measured environment are independent of IA-32e mode. This also applies to the interpreta-</div>
<div id="t17_1985" class="t s3_1985">tion of register widths</div>
<div id="t18_1985" class="t s5_1985">1</div>
<div id="t19_1985" class="t s3_1985">passed as input parameters to GETSEC functions and to register results returned as output </div>
<div id="t1a_1985" class="t s3_1985">parameters.</div>
<div id="t1b_1985" class="t s3_1985">The GETSEC functions ENTERACCS, SENTER, SEXIT, and WAKEUP require a Intel</div>
<div id="t1c_1985" class="t s5_1985">®</div>
<div id="t1d_1985" class="t s3_1985">TXT capable-chipset to be </div>
<div id="t1e_1985" class="t s3_1985">present in the platform. The GETSEC[CAPABILITIES] returned bit vector in position 0 indicates an Intel</div>
<div id="t1f_1985" class="t s5_1985">®</div>
<div id="t1g_1985" class="t s3_1985">TXT-</div>
<div id="t1h_1985" class="t s3_1985">capable chipset has been sampled present</div>
<div id="t1i_1985" class="t s5_1985">2</div>
<div id="t1j_1985" class="t s3_1985">by the processor.</div>
<div id="t1k_1985" class="t s3_1985">The processor's operating mode also affects the execution of the following GETSEC leaf functions: SMCTRL, ENTER-</div>
<div id="t1l_1985" class="t s3_1985">ACCS, EXITAC, SENTER, SEXIT, and WAKEUP. These functions are only allowed in protected mode at CPL = 0. They </div>
<div id="t1m_1985" class="t s6_1985">1.</div>
<div id="t1n_1985" class="t s6_1985">This chapter uses the 64-bit notation RAX, RIP, RSP, RFLAGS, etc. for processor registers because processors that support SMX also </div>
<div id="t1o_1985" class="t s6_1985">support Intel 64 Architecture. The MVMM can be launched in IA-32e mode or outside IA-32e mode. The 64-bit notation of processor </div>
<div id="t1p_1985" class="t s6_1985">registers also refer to its 32-bit forms if SMX is used in 32-bit environment. In some places, notation such as EAX is used to refer </div>
<div id="t1q_1985" class="t s6_1985">specifically to lower 32 bits of the indicated register</div>
<div id="t1r_1985" class="t s6_1985">2.</div>
<div id="t1s_1985" class="t s6_1985">Sampled present means that the processor sent a message to the chipset and the chipset responded that it (a) knows about the </div>
<div id="t1t_1985" class="t s6_1985">message and (b) is capable of executing SENTER. This means that the chipset CAN support Intel® TXT, and is configured and WILLING </div>
<div id="t1u_1985" class="t s6_1985">to support it.</div>

<!-- End text definitions -->


</div>
</body>
</html>
